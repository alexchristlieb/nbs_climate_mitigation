# **README: Climate Mitigation Potential of Urban NBS**

This repository contains the code, data, and methodology for assessing the climate mitigation potential of nature-based solutions (NBS), focusing on green roofs in Zurich. The project combines spatial Multi-Criteria Decision Analysis (MCDA) using SSANTO with high-resolution heating emission mapping to prioritize and quantify NBS allocation for urban decarbonization.

---

## **Project Overview**
The study aims to:
1. Disaggregate heating emissions for Zurich using GIS-based modeling.
2. Integrate these emissions into the SSANTO MCDA framework alongside environmental and feasibility criteria.
3. Allocate green roofs to optimal locations and estimate their potential for reducing carbon emissions and heating energy demand.
4. Provide a transferable methodology for other cities and NBS types.

---

## **Repository Structure**
### **Code**
1. **`data_exploration.ipynb`**
   - Preprocessing pipeline for all input data required for the disaggregation process.
   - Includes reprojecting datasets to CRS 2056, ensuring compatibility for Zurich-specific analysis.

2. **`heating_disaggregated.Rmd`**
   - R script implementing the disaggregation methodology for residential and commercial heating emissions.
   - Produces a high-resolution emission raster (`em_res_ind_high_res.tif`).

3. **`heating_emission_factor.ipynb`**
   - Calculates the heating emission factor based on building heating demands and heating type percentages.
   - Uses datasets from `Heating Emission Factor Data`.

4. **`value_scales_preprocessing.ipynb`**
   - Prepares and standardizes input criteria for the SSANTO MCDA model.
   - Reprojects and aligns raw value scales for use in the suitability analysis.

5. **`postprocessing.ipynb`**
   - Processes the SSANTO model outputs.
   - Calculates carbon emission savings from allocated green roofs using results from the MCDA.

---

### **Data**
1. **`Data/GID`**
   - Contains the Global Emissions Dataset (GID) used as the low-resolution baseline for disaggregation.
   - Note: This dataset cannot be shared due to copyright restrictions. It must be downloaded separately from the official GID website.

2. **`Data/Heating Emission Factor Data`**
   - Contains files used for calculating heating emission factors:
     - `extended_municipal_data.csv`: Extended dataset with municipal-level details.
     - `heating_type_percentage.csv`: Percentages of heating types (e.g., gas, electric) used in Zurich.
     - `X_raw.csv`: Raw data inputs for computing emission factors.

3. **`Data/ZH`**
   - Files specific to the Zurich case study:
     - **Boundary:**
       - Contains shapefiles and geographic boundaries of Zurich.
     - **MCDA-Criteria:**
       - Input layers for SSANTO's environmental objectives, such as population and heat vulnerability.
     - **Rasters:**
       - `lulc_res_ind_raster_30m_full.tif`: Full-resolution Land Use/Land Cover (LULC) raster with residential and industrial areas.
       - `lulc_res_ind_raster_30m.tif`: Cropped LULC raster focused on Zurich city limits.
       - `em_res_ind_high_res.tif`: High-resolution disaggregated emissions map generated after the disaggregation step.
       - `pop.tif`: Population raster for Zurich city.
       - `pop_density_2056.tif`: High-resolution European population density raster.
     - **Vector Data:**
       - `polygon.shp`: Polygon shapefile representing Zurich city boundaries.

---

### **Results**
The `Results` folder contains outputs from the SSANTO model, green roof allocation results, and carbon reduction calculations. The subfolders represent the scenarios evaluated, based on the weight assigned to the emissions reduction objective in the SSANTO MCDA process:
- **`15/`**: Represents the Balanced scenario where the emissions reduction objective has a 15% weight.
- **Contents:**
  - `.ssanto`: The SSANTO model configuration file with weights and model data.
  - `ssanto-map.tif`: The raw suitability map generated by SSANTO as a raster file.
  - `results_*.csv`: CSV files summarizing results (e.g., allocated green roofs and carbon reduction metrics).
  - `emissions_green_roofs_overlay.png`: Visualization of emissions reduction and green roof allocation.
  - `green_roofs_potential.png`: Image summarizing the potential of green roofs in the scenario.
  - `SSANTO-Report.pdf`: Detailed SSANTO outputs, including criteria weights and suitability map analysis.
  - Additional subfolders (`30/`, `100/`, `Base/`, `Pan/`) represent other scenarios.

---

## **Usage Instructions**
### **1. Preprocessing**
Run `data_exploration.ipynb` to preprocess the input data, including population, LULC, and boundary datasets. Ensure all files are reprojected to CRS 2056.

### **2. Emission Disaggregation**
Use `heating_emission_factor.ipynb` to calculate emission factors, followed by `heating_disaggregated.Rmd` to create the high-resolution emission raster (`em_res_ind_high_res.tif`).

### **3. Value Scale Preparation**
Run `value_scales_preprocessing.ipynb` to standardize the value scales required for the MCDA.

### **4. SSANTO Analysis**
Load the processed data into SSANTO for suitability mapping, using the files in `Data/ZH/MCDA-Criteria`.

### **5. Postprocessing**
Use `postprocessing.ipynb` to analyze SSANTO outputs, allocate green roofs, and calculate emission reductions.

---

## **Key Notes**
- **Dependencies:** Ensure that R and Python environments are set up with all necessary geospatial libraries (e.g., `terra`, `rasterio`, `geopandas`).
- **Data Access:** Due to copyright restrictions, you must obtain approval to access the GID dataset from its official source.
- **Scalability:** The methodology is transferable to other urban contexts and can be adapted to evaluate different NBS types, such as street trees or urban wetlands.

---

## **Acknowledgments**
This work leverages the SSANTO framework and builds on emission disaggregation methodologies by \textcite{kuller_planning-support_2019} and \textcite{pan_contribution_2023}. We thank all contributors who made this project possible.  
